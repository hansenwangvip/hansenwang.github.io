---

title: Array.prototype.sort()的高级用法
categories: 前端
date: 2018-01-28 
update: 2018-04-18
tags: [JavaScript]

---

# Array.prototype.sort()
## 一、基本操作
`sort()`方法的默认排序顺序是根据串Unicode码点。

```
var fruit = ['cherries', 'apples', 'bananas'];
fruit.sort();
//['apples', 'bananas', 'cherries']

var scores = [1, 10, 21, 2];
scores.sort();
//[1, 10, 2, 21]
//这里的10竟然在2之前，因为在Unicode指针顺序中 '10' 在 '2' 之前。
```

## 二、进阶操作（compareFunction）
这时我们需要一个比较函数，来得到我们所需要的排序。
如果指明了`compareFunction`,那么数组会按照调用**该函数的返回值**排序。即a和b是两个将要被比较的元素：

### 2.0 字符串排序
```
var str_arr = ['cherries', 'apples', 'bananas'];
function compareStr(a, b){
	if(a<b){
		return -1;
	}
	if(a>b){
		return 1;
	}
	return 0;
}
str_arr.sort(compareStr);
// ['apples', 'bananas', 'cherries']
```

### 2.1 数字排序

- 如果compareFunction(a, b)小于0，那么a会排到b之前；
- 如果compareFunction(a, b)等于0 ,  那么位置不变；
- 如果compareFunction(a, b)大于0，那么b会排到a之前；
```
function compareNumbers(a, b){
	return a - b;
}

var numbers = [4, 2, 5, 1, 3];
numbers.sort(function(a, b){
	return a - b;
});
console.log(numbers);

//也可以写成：
var numbers = [4, 2, 5, 1, 3];
numbers.sort((a, b) => a - b);
console.log(numbers);

//输出：[1, 2, 3, 4, 5]
```
 
### 2.2 对象按照某个属性排序

``` js
var items = [
  { name: 'Edward', value: 21 },
  { name: 'Sharpe', value: 37 },
  { name: 'And', value: 45 },
  { name: 'The', value: -12 },
  { name: 'Magnetic' },
  { name: 'Zeros', value: 37 }
];

//按value值排序
items.sort(function (a,b){
	return (a,.value - b.value)
});

//按name值排序
items.sort(function(a, b){
	var nameA = a.name.toUpperCase();
	var nameB = b.name.toUpperCase();
	if(nameA < nameB){
		return -1;
	}
	if(nameA > nameB){
		return 1;
	}
	return 0;
});
```

## 三、高级操作：使用映射改善排序
`compareFunction`可能需要对元素做多次映射以实现排序，尤其当compareFunction较为复杂，且元素较多的时候，某些compareFunction 可能会导致很高的负载。使用map辅助排序将会是个好主意。

基本思想是首先将数组中的每个元素比较的实际值取出来，排序后再将数组恢复。

```
// 需要被排序的数组
var list = ['Delta', 'alpha', 'CHARLIE', 'bravo'];

// 对需要排序的数字和位置的临时存储, mapped为临时容器
var mapped = list.map(function(el, i) {
  return { index: i, value: el.toLowerCase() };
})

// 按照多个值排序数组
mapped.sort(function(a, b) {
  return +(a.value > b.value) || +(a.value === b.value) - 1;
});

// 根据索引得到排序的结果
var result = mapped.map(function(el){
  return list[el.index];
});
//result : ["alpha", "bravo", "CHARLIE", "Delta"]
```
